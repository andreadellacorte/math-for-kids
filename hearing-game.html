---
title: "Hearing Game - Music Trivia"
custom_css: |
        .hearing-container {
            max-width: 800px;
            margin: 0 auto;
            text-align: center;
            padding: 20px;
        }

        .audio-display {
            background: #f8f9fa;
            border: 3px solid #007bff;
            border-radius: 15px;
            padding: 40px 20px;
            margin: 20px 0;
            min-height: 120px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5em;
        }

        .patterns-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .pattern-option {
            background: #fff;
            border: 3px solid #dee2e6;
            border-radius: 15px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            min-height: 150px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .pattern-option:hover {
            border-color: #007bff;
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(0, 123, 255, 0.3);
        }

        .pattern-option.selected {
            border-color: #007bff;
            background: #e7f3ff;
        }

        .pattern-option.correct {
            border-color: #28a745;
            background: #d4edda;
            color: #155724;
        }

        .pattern-option.incorrect {
            border-color: #dc3545;
            background: #f8d7da;
            color: #721c24;
        }

        .pattern-visual {
            font-size: 2em;
            margin: 10px 0;
            font-family: monospace;
            line-height: 1.2;
        }

        .pattern-label {
            font-size: 1.1em;
            font-weight: bold;
            margin-top: 10px;
        }

        .sequence-display {
            background: #e9ecef;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            font-size: 1.2em;
            min-height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .controls {
            margin: 20px 0;
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .game-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 15px;
            margin: 20px 0;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }

        .stat-card {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            border: 2px solid #dee2e6;
        }

        .stat-value {
            font-size: 2em;
            font-weight: bold;
            color: #007bff;
        }

        .volume-control {
            margin: 20px 0;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .volume-control input {
            width: 150px;
        }

        .note-info {
            background: #fff3cd;
            border: 2px solid #ffeaa7;
            border-radius: 10px;
            padding: 15px;
            margin: 20px 0;
            color: #856404;
            font-size: 0.9em;
        }

        @media (max-width: 768px) {
            .patterns-container {
                grid-template-columns: 1fr;
            }

            .pattern-visual {
                font-size: 1.5em;
            }
        }
---
    <div class="container">
        <div class="header">
            <a href="music-trivia.html" class="back-btn">‚Üê Back to Music Trivia</a>
            <h1>üëÇ Hearing Game</h1>
        </div>

        <div class="hearing-container">
            <p class="subtitle">Listen to three-note sequences and identify their movement patterns!</p>

            <div class="game-stats">
                <div class="stat-card">
                    <div class="stat-value" id="score">0</div>
                    <div>Score</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="level">1</div>
                    <div>Level</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="streak">0</div>
                    <div>Streak</div>
                </div>
            </div>

            <div class="audio-display" id="audioDisplay">
                Click "New Sequence" to start listening!
            </div>

            <div class="volume-control">
                <span>üîä Volume:</span>
                <input type="range" id="volumeSlider" min="0" max="100" value="50">
                <span id="volumeValue">50%</span>
            </div>

            <div class="controls">
                <button class="btn" id="newSequenceBtn">New Sequence</button>
                <button class="btn secondary" id="playBtn" disabled>Play Again</button>
                <button class="btn secondary" id="checkBtn" disabled>Check Answer</button>
            </div>

            <div class="sequence-display" id="sequenceDisplay">
                Sequence will be displayed here after you listen...
            </div>

            <div class="patterns-container" id="patternsContainer">
                <!-- Pattern options will be generated by JavaScript -->
            </div>

            <div class="note-info">
                <strong>Pattern Types:</strong><br>
                <strong>Ascending:</strong> Notes go up (Low ‚Üí Medium ‚Üí High)<br>
                <strong>Descending:</strong> Notes go down (High ‚Üí Medium ‚Üí Low)<br>
                <strong>Up-down:</strong> Notes go up then down (Low ‚Üí High ‚Üí Medium)<br>
                <strong>Down-up:</strong> Notes go down then up (High ‚Üí Low ‚Üí Medium)<br>
                <strong>Repeat:</strong> Same note played three times (Same ‚Üí Same ‚Üí Same)
            </div>

            <div class="info-box" style="margin-top: 30px;">
                <h3>How to Play:</h3>
                <p>1. Click "New Sequence" to hear a three-note musical sequence</p>
                <p>2. Listen carefully to how the pitch changes between the notes</p>
                <p>3. Select the pattern that best describes what you heard</p>
                <p>4. Use "Play Again" to replay the sequence if needed</p>
                <p>5. Click "Check Answer" to see if you identified the pattern correctly</p>
            </div>
        </div>
    </div>

    <script>
        class HearingGame {
            constructor() {
                this.patterns = [
                    {
                        name: 'Ascending',
                        description: 'Going Up',
                        visual: '‚ô™ ‚Üó ‚ô™ ‚Üó ‚ô™',
                        generator: () => this.generateAscending()
                    },
                    {
                        name: 'Descending',
                        description: 'Going Down',
                        visual: '‚ô™ ‚Üò ‚ô™ ‚Üò ‚ô™',
                        generator: () => this.generateDescending()
                    },
                    {
                        name: 'Up-down',
                        description: 'Up then Down',
                        visual: '‚ô™ ‚Üó ‚ô™ ‚Üò ‚ô™',
                        generator: () => this.generateUpDown()
                    },
                    {
                        name: 'Down-up',
                        description: 'Down then Up',
                        visual: '‚ô™ ‚Üò ‚ô™ ‚Üó ‚ô™',
                        generator: () => this.generateDownUp()
                    },
                    {
                        name: 'Repeat',
                        description: 'Same Note',
                        visual: '‚ô™ ‚Üí ‚ô™ ‚Üí ‚ô™',
                        generator: () => this.generateRepeat()
                    }
                ];

                this.baseFrequencies = [
                    261.63, // C4
                    293.66, // D4
                    329.63, // E4
                    349.23, // F4
                    392.00, // G4
                    440.00, // A4
                    493.88, // B4
                    523.25  // C5
                ];

                this.currentSequence = [];
                this.currentPattern = null;
                this.selectedPattern = null;
                this.score = 0;
                this.level = 1;
                this.streak = 0;
                this.volume = 0.5;

                // Audio context
                this.audioContext = null;
                this.initAudio();

                this.initializeElements();
                this.createPatternOptions();
                this.attachEventListeners();
                this.updateDisplay();
            }

            async initAudio() {
                try {
                    this.audioContext = new (window.AudioContext || window.webkitAudioContext)();
                } catch (error) {
                    console.warn('Audio context not available:', error);
                }
            }

            initializeElements() {
                this.scoreElement = document.getElementById('score');
                this.levelElement = document.getElementById('level');
                this.streakElement = document.getElementById('streak');
                this.audioDisplay = document.getElementById('audioDisplay');
                this.sequenceDisplay = document.getElementById('sequenceDisplay');
                this.patternsContainer = document.getElementById('patternsContainer');
                this.volumeSlider = document.getElementById('volumeSlider');
                this.volumeValue = document.getElementById('volumeValue');

                this.newSequenceBtn = document.getElementById('newSequenceBtn');
                this.playBtn = document.getElementById('playBtn');
                this.checkBtn = document.getElementById('checkBtn');
            }

            createPatternOptions() {
                this.patternsContainer.innerHTML = '';

                this.patterns.forEach((pattern, index) => {
                    const option = document.createElement('div');
                    option.className = 'pattern-option';
                    option.dataset.pattern = pattern.name;

                    option.innerHTML = `
                        <div class="pattern-visual">${pattern.visual}</div>
                        <div class="pattern-label">${pattern.name}</div>
                        <div style="font-size: 0.9em; color: #666;">${pattern.description}</div>
                    `;

                    option.addEventListener('click', () => this.selectPattern(pattern.name, option));
                    this.patternsContainer.appendChild(option);
                });
            }

            attachEventListeners() {
                this.newSequenceBtn.addEventListener('click', () => this.generateNewSequence());
                this.playBtn.addEventListener('click', () => this.playCurrentSequence());
                this.checkBtn.addEventListener('click', () => this.checkAnswer());

                this.volumeSlider.addEventListener('input', (e) => {
                    this.volume = e.target.value / 100;
                    this.volumeValue.textContent = `${e.target.value}%`;
                });
            }

            generateNewSequence() {
                // Reset game state
                this.currentSequence = [];
                this.selectedPattern = null;
                this.clearPatternSelection();

                // Choose a random pattern
                this.currentPattern = this.patterns[Math.floor(Math.random() * this.patterns.length)];

                // Generate sequence based on pattern
                this.currentSequence = this.currentPattern.generator();

                this.audioDisplay.textContent = 'Playing sequence... üéµ';
                this.sequenceDisplay.textContent = 'Listen carefully and select the pattern you hear...';

                this.playCurrentSequence();

                this.playBtn.disabled = false;
                this.checkBtn.disabled = false;
            }

            generateAscending() {
                // Three notes going up
                const start = Math.floor(Math.random() * 4); // 0-3
                return [
                    this.baseFrequencies[start],
                    this.baseFrequencies[start + 2],
                    this.baseFrequencies[start + 4]
                ];
            }

            generateDescending() {
                // Three notes going down
                const start = Math.floor(Math.random() * 4) + 4; // 4-7
                return [
                    this.baseFrequencies[start],
                    this.baseFrequencies[start - 2],
                    this.baseFrequencies[start - 4]
                ];
            }

            generateUpDown() {
                // Low, high, medium
                const base = Math.floor(Math.random() * 3); // 0-2
                return [
                    this.baseFrequencies[base],
                    this.baseFrequencies[base + 4],
                    this.baseFrequencies[base + 2]
                ];
            }

            generateDownUp() {
                // High, low, medium
                const base = Math.floor(Math.random() * 3) + 4; // 4-6
                return [
                    this.baseFrequencies[base],
                    this.baseFrequencies[base - 4],
                    this.baseFrequencies[base - 2]
                ];
            }

            generateRepeat() {
                // Three notes of the same pitch
                const base = Math.floor(Math.random() * 6) + 1; // 1-6
                return [
                    this.baseFrequencies[base],
                    this.baseFrequencies[base],
                    this.baseFrequencies[base]
                ];
            }


            async playCurrentSequence() {
                if (!this.audioContext || this.currentSequence.length === 0) return;

                this.audioDisplay.textContent = 'Playing sequence... üéµ';

                for (let i = 0; i < this.currentSequence.length; i++) {
                    this.playNote(this.currentSequence[i], 0.8);
                    await this.sleep(900); // Pause between notes
                }

                this.audioDisplay.textContent = 'Select the pattern you heard!';
            }

            playNote(frequency, duration) {
                if (!this.audioContext) return;

                const oscillator = this.audioContext.createOscillator();
                const gainNode = this.audioContext.createGain();

                oscillator.connect(gainNode);
                gainNode.connect(this.audioContext.destination);

                oscillator.frequency.setValueAtTime(frequency, this.audioContext.currentTime);
                oscillator.type = 'sine';

                gainNode.gain.setValueAtTime(this.volume * 0.3, this.audioContext.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, this.audioContext.currentTime + duration);

                oscillator.start(this.audioContext.currentTime);
                oscillator.stop(this.audioContext.currentTime + duration);
            }

            sleep(ms) {
                return new Promise(resolve => setTimeout(resolve, ms));
            }

            selectPattern(patternName, element) {
                // Clear previous selection
                this.clearPatternSelection();

                // Set new selection
                this.selectedPattern = patternName;
                element.classList.add('selected');

                this.sequenceDisplay.textContent = `Selected: ${patternName}`;
            }

            clearPatternSelection() {
                document.querySelectorAll('.pattern-option').forEach(option => {
                    option.classList.remove('selected', 'correct', 'incorrect');
                });
            }

            checkAnswer() {
                if (!this.selectedPattern) {
                    this.sequenceDisplay.textContent = 'Please select a pattern first!';
                    return;
                }

                const isCorrect = this.selectedPattern === this.currentPattern.name;
                this.showResults(isCorrect);

                if (isCorrect) {
                    this.score += 20 + (this.level * 5);
                    this.streak++;

                    if (this.streak % 4 === 0) {
                        this.level++;
                        this.audioDisplay.textContent = `üéâ Level Up! Now level ${this.level}!`;
                    }
                } else {
                    this.streak = 0;
                }

                this.updateDisplay();

                // Reset for next round
                setTimeout(() => {
                    this.clearPatternSelection();
                    this.playBtn.disabled = true;
                    this.checkBtn.disabled = true;
                    this.sequenceDisplay.textContent = 'Ready for the next sequence...';
                }, 3000);
            }

            showResults(isCorrect) {
                // Show correct answer and user selection
                document.querySelectorAll('.pattern-option').forEach(option => {
                    const patternName = option.dataset.pattern;

                    if (patternName === this.currentPattern.name) {
                        option.classList.add('correct');
                    } else if (patternName === this.selectedPattern && !isCorrect) {
                        option.classList.add('incorrect');
                    }
                });

                if (isCorrect) {
                    this.audioDisplay.textContent = 'üéâ Excellent! You identified the pattern correctly!';
                    this.sequenceDisplay.textContent = `‚úÖ Correct! It was ${this.currentPattern.name}`;
                } else {
                    this.audioDisplay.textContent = '‚ùå Not quite right. Try listening again!';
                    this.sequenceDisplay.textContent = `‚ùå The correct pattern was: ${this.currentPattern.name}`;
                }
            }

            updateDisplay() {
                this.scoreElement.textContent = this.score;
                this.levelElement.textContent = this.level;
                this.streakElement.textContent = this.streak;
            }
        }

        // Initialize game when page loads
        document.addEventListener('DOMContentLoaded', () => {
            new HearingGame();
        });
    </script>

    </div>